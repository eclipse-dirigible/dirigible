<!--

    Copyright (c) 2010-2025 Eclipse Dirigible contributors

    All rights reserved. This program and the accompanying materials
    are made available under the terms of the Eclipse Public License v2.0
    which accompanies this distribution, and is available at
    http://www.eclipse.org/legal/epl-v20.html

    SPDX-FileCopyrightText: Eclipse Dirigible contributors
    SPDX-License-Identifier: EPL-2.0

-->
<!DOCTYPE html>
<html lang="en" ng-app="transfer" ng-controller="ViewController" xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" sizes="any" href="data:;base64,iVBORw0KGgo=">
        <title config-title></title>
        <script type="text/javascript" src="configs/transfer-view.js"></script>
        <script type="text/javascript" src="/services/js/platform-core/services/loader.js?id=view-js"></script>
        <link type="text/css" rel="stylesheet" href="/services/js/platform-core/services/loader.js?id=view-css" />
        <script type="text/javascript" src="js/transfer.js"></script>
        <style>
            .logLine {
                background: var(--fdList_Item_Background_Color);
            }

            [data-loglevel='INFO'] {
                color: var(--sapInformativeTextColor);
            }

            [data-loglevel='WARN'] {
                color: var(--sapCriticalTextColor);
            }

            [data-loglevel='ERROR'] {
                color: var(--sapNegativeTextColor);
            }

        </style>
    </head>

    <body class="bk-hbox">
        <bk-vertical-nav can-scroll="true" style="min-width:4.625rem;width:auto;z-index:2">
            <bk-vertical-nav-main-section aria-label="main navigation">
                <bk-list>
                    <bk-list-navigation-item indicated="navActive === 'transfer'" ng-click="switchNav('transfer')">
                        <span bk-list-navigation-item-text>Transfer</span>
                        <bk-list-navigation-item-indicator ng-if="navActive === 'transfer'"></bk-list-navigation-item-indicator>
                    </bk-list-navigation-item>
                    <bk-list-navigation-item indicated="navActive === 'export'" ng-click="switchNav('export')">
                        <span bk-list-navigation-item-text>Export</span>
                        <bk-list-navigation-item-indicator ng-if="navActive === 'export'"></bk-list-navigation-item-indicator>
                    </bk-list-navigation-item>
                    <bk-list-navigation-item indicated="navActive === 'import'" ng-click="switchNav('import')">
                        <span bk-list-navigation-item-text>Import</span>
                        <bk-list-navigation-item-indicator ng-if="navActive === 'import'"></bk-list-navigation-item-indicator>
                    </bk-list-navigation-item>
                </bk-list>
            </bk-vertical-nav-main-section>
        </bk-vertical-nav>
        <div class="bk-fill-parent" ng-show="navActive === 'transfer'" ng-controller="TransferController">
            <div class="fd-padding-begin-end--tiny bk-padding-top--tiny">
                <div class="fd-container fd-form-layout-grid-container bk-padding--none">
                    <div class="fd-row">
                        <bk-form-label class="fd-col fd-col--6">Source:</bk-form-label>
                        <bk-form-label class="fd-col fd-col--6">Target:</bk-form-label>
                    </div>
                    <div class="fd-row">
                        <div class="fd-col fd-col--6">
                            <div class="fd-row">
                                <div class="fd-col fd-col--12 fd-col-lg--6">
                                    <label id="sd" style="display: none">Source database</label>
                                    <bk-select label-id="sd" class="bk-full-width" ng-model="definition.selectedSourceDatabase" ng-change="databaseSourceChanged()">
                                        <bk-option text="{{ database }}" value="database" ng-repeat="database in databases track by $index"></bk-option>
                                    </bk-select>
                                </div>
                                <div class="fd-col fd-col--12 fd-col-lg--6">
                                    <label id="sds" style="display: none">Source schema</label>
                                    <bk-select label-id="sds" class="bk-full-width" ng-model="definition.selectedSourceDatasource">
                                        <bk-option text="{{ datasource }}" value="datasource" ng-repeat="datasource in sourceDatasources track by $index"></bk-option>
                                    </bk-select>
                                </div>
                            </div>
                        </div>
                        <div class="fd-col fd-col--6">
                            <div class="fd-row">
                                <div class="fd-col fd-col--12 fd-col-lg--6">
                                    <label id="td" style="display: none">Target database</label>
                                    <bk-select label-id="td" class="bk-full-width" ng-model="definition.selectedTargetDatabase" ng-change="databaseTargetChanged()">
                                        <bk-option text="{{ database }}" value="database" ng-repeat="database in databases track by $index"></bk-option>
                                    </bk-select>
                                </div>
                                <div class="fd-col fd-col--12 fd-col-lg--6">
                                    <label id="tds" style="display: none">Target schema</label>
                                    <bk-select aria-label="tds" class="bk-full-width" ng-model="definition.selectedTargetDatasource">
                                        <bk-option text="{{ datasource }}" value="datasource" ng-repeat="datasource in targetDatasources track by $index"></bk-option>
                                    </bk-select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <bk-toolbar compact="true" type="transparent">
                <bk-toolbar-spacer></bk-toolbar-spacer>
                <bk-button state="emphasized" glyph="sap-icon--media-play" title="Start Transfer" label="Start" ng-click="startTransfer()"></bk-button>
                <!-- <bk-button state="transparent" glyph="sap-icon--media-pause" title="Stop Transfer" aria-label="Stop Transfer" ng-click="stopTransfer()"></bk-button> -->
                <bk-toolbar-separator></bk-toolbar-separator>
                <bk-button state="transparent" glyph="sap-icon--clear-all" title="Clear Log" aria-label="Clear Log" ng-click="clearLog()"></bk-button>
            </bk-toolbar>
            <div id="logContent" class="bk-stretch" bk-scrollbar>
                <div class="fd-text bk-padding--tiny logLine" data-loglevel="{{::log.level}}" ng-repeat="log in logs track by $index">
                    {{::log.date}} {{::log.message}}
                </div>
            </div>
        </div>
        <div class="bk-fill-parent bk-hbox" ng-show="navActive === 'export'" ng-controller="ExportController">
            <bk-busy-indicator-extended class="bk-fill-parent" ng-show="exportLoading" size="l">Starting export...</bk-busy-indicator-extended>
            <bk-fieldset class="bk-padding--tiny bk-restrict-width--sm bk-full-width" bk-scrollbar ng-form="forms.ep" ng-hide="exportLoading">
                <bk-form-group>
                    <bk-form-item>
                        <bk-form-label id="db" required colon="true">Database</bk-form-label>
                        <bk-select label-id="db" name="db" class="bk-full-width" ng-required="true" ng-model="exportData.db" ng-change="dbChanged()" state="{{ forms.ep['db'].$valid ? '' : 'error' }}">
                            <bk-option text="{{ database }}" value="database" ng-repeat="database in databases track by $index"></bk-option>
                        </bk-select>
                    </bk-form-item>
                    <bk-form-item>
                        <bk-form-label id="source" required colon="true">Source</bk-form-label>
                        <bk-select label-id="source" name="source" class="bk-full-width" ng-required="true" ng-model="exportData.source" ng-change="sourceChanged()" state="{{ forms.ep['source'].$valid ? '' : 'error' }}">
                            <bk-option text="{{ datasource }}" value="datasource" ng-repeat="datasource in datasources track by $index"></bk-option>
                        </bk-select>
                    </bk-form-item>
                    <bk-form-item class="bk-hbox bk-box--gap">
                        <bk-form-item class="bk-full-width">
                            <bk-form-label for="tables" colon="true">Tables</bk-form-label>
                            <bk-combobox-input input-id="tables" multi-select="true" ng-model="exportData.tables" filter="Contains" dropdown-items="tables" placeholder="Search..." btn-aria-label="show/hide table options"
                                list-aria-label="table options">
                            </bk-combobox-input>
                        </bk-form-item>
                        <bk-form-item style="margin:0">
                            <bk-form-label id="lt" colon="true">Type</bk-form-label>
                            <bk-select label-id="lt" name="type" ng-model="exportData.type" state="{{ forms.ep['type'].$valid ? '' : 'error' }}">
                                <bk-option text="Include" value="'include'"></bk-option>
                                <bk-option text="Exclude" value="'exclude'"></bk-option>
                            </bk-select>
                        </bk-form-item>
                    </bk-form-item>
                    <bk-form-item>
                        <bk-message-strip glyph="sap-icon--message-information" state="information">Leave selection empty to include all tables</bk-message-strip>
                    </bk-form-item>
                    <bk-form-item>
                        <bk-form-label for="path" required colon="true">Output folder</bk-form-label>
                        <bk-input-group state="{{ forms.ep['path'].$valid ? '' : 'error' }}">
                            <bk-input id="path" name="path" type="text" ng-model="exportData.path" ng-required="true" placeholder="/export/path"></bk-input>
                            <bk-input-group-addon>
                                <bk-button glyph="sap-icon--folder-blank" label="Choose" title="Choose" ng-click="choosePath()"></bk-button>
                            </bk-input-group-addon>
                        </bk-input-group>
                    </bk-form-item>
                    <bk-form-item class="bk-box--items-end">
                        <bk-button type="button" state="emphasized" label="Export" ng-click="startExport()" ng-disabled="!forms.ep.$valid || exportLoading"></bk-button>
                    </bk-form-item>
                </bk-form-group>
            </bk-fieldset>
            <div class="bk-vbox bk-list-border--left bk-fill-parent" ng-hide="exportLoading">
                <bk-toolbar type="transparent">
                    <bk-toolbar-title>Exports</bk-toolbar-title>
                </bk-toolbar>
                <bk-list list-type="navigation-indication" fixed-height="true" byline="exports.length > 0">
                    <bk-list-item interactive="true" ng-repeat="export in exports track by export.id" ng-click="goToDocuments(export.path)">
                        <bk-list-link navigation-indicator="true">
                            <bk-list-thumbnail ng-if="!export.exporting" glyph="sap-icon--message-success"></bk-list-thumbnail>
                            <bk-list-thumbnail ng-if="export.exporting" loading="true"></bk-list-thumbnail>
                            <bk-list-content item-title="{{export.path}}">
                                <bk-list-byline align="left">{{export.db}}.{{export.source}}</bk-list-byline>
                                <bk-list-byline align="right">{{export.time}}</bk-list-byline>
                            </bk-list-content>
                        </bk-list-link>
                    </bk-list-item>
                    <bk-list-item ng-if="exports.length === 0">
                        <bk-list-title style="text-align: center">No exports</bk-list-title>
                    </bk-list-item>
                </bk-list>
            </div>
        </div>
        <div class="bk-fill-parent bk-hbox" ng-show="navActive === 'import'" ng-controller="ImportController">
            <bk-busy-indicator-extended class="bk-fill-parent" ng-show="importLoading" size="l">Starting import...</bk-busy-indicator-extended>
            <bk-fieldset class="bk-padding--tiny bk-restrict-width--sm bk-full-width" bk-scrollbar ng-form="forms.ep" ng-hide="importLoading">
                <bk-form-group>
                    <bk-form-item>
                        <bk-form-label id="db" required colon="true">Database</bk-form-label>
                        <bk-select label-id="db" name="db" class="bk-full-width" ng-required="true" ng-model="importData.db" ng-change="dbChanged()" state="{{ forms.ep['db'].$valid ? '' : 'error' }}">
                            <bk-option text="{{ database }}" value="database" ng-repeat="database in databases track by $index"></bk-option>
                        </bk-select>
                    </bk-form-item>
                    <bk-form-item>
                        <bk-form-label for="path" required colon="true">Import folder</bk-form-label>
                        <bk-input-group state="{{ forms.ep['path'].$valid ? '' : 'error' }}">
                            <bk-input id="path" name="path" type="text" ng-model="importData.path" ng-required="true" placeholder="/import/path"></bk-input>
                            <bk-input-group-addon>
                                <bk-button glyph="sap-icon--folder-blank" label="Choose" title="Choose" ng-click="choosePath()"></bk-button>
                            </bk-input-group-addon>
                        </bk-input-group>
                    </bk-form-item>
                    <bk-form-item class="bk-box--items-end">
                        <bk-button type="button" state="emphasized" label="Import" ng-click="startImport()" ng-disabled="!forms.ep.$valid || importLoading"></bk-button>
                    </bk-form-item>
                </bk-form-group>
            </bk-fieldset>
            <div class="bk-vbox bk-list-border--left bk-fill-parent" ng-hide="importLoading">
                <bk-toolbar type="transparent">
                    <bk-toolbar-title>Imports</bk-toolbar-title>
                </bk-toolbar>
                <bk-list list-type="navigation-indication" fixed-height="true" byline="imports.length > 0">
                    <bk-list-item interactive="true" ng-repeat="import in imports track by import.id" ng-click="goToDocuments(import.path)">
                        <bk-list-link navigation-indicator="true">
                            <bk-list-thumbnail ng-if="!import.importing" glyph="sap-icon--message-success"></bk-list-thumbnail>
                            <bk-list-thumbnail ng-if="import.importing" loading="true"></bk-list-thumbnail>
                            <bk-list-content item-title="{{import.path}}">
                                <bk-list-byline align="left">{{import.db}}</bk-list-byline>
                                <bk-list-byline align="right">{{import.time}}</bk-list-byline>
                            </bk-list-content>
                        </bk-list-link>
                    </bk-list-item>
                    <bk-list-item ng-if="imports.length === 0">
                        <bk-list-title style="text-align: center">No imports</bk-list-title>
                    </bk-list-item>
                </bk-list>
            </div>
        </div>
        <theme></theme>
    </body>
