/*
 * Generated by Eclipse Dirigible based on model and template.
 *
 * Do not modify the content as it may be re-generated again.
 */
const reportFileTemplate = dirigibleRequire("template-application-ui-angular/template/ui/reportFile");
const generateUtils = dirigibleRequire("ide-generate-service/template/generateUtils");
const parameterUtils = dirigibleRequire("ide-generate-service/template/parameterUtils");

exports.generate = function (model, parameters) {
    model = JSON.parse(model);
    let templateSources = exports.getTemplate(parameters).sources;
    model?.columns?.forEach(e => {
        const parsedDataType = parameterUtils.parseDataTypes(e.type);
        e.typeJava = parsedDataType.java;
        e.typeTypescript = parsedDataType.ts;
    });
    if (parameters.extensionPoint === undefined) {
        parameters.extensionPoint = parameters.projectName;
    }
    if (parameters.name === undefined) {
        parameters.name = parameters.fileName;
    }
    if (parameters.perspectiveName === undefined) {
        parameters.perspectiveName = parameters.fileName;
    }
    console.error(`Model is: ${JSON.stringify(model)}`);
    return generateUtils.generateGeneric(model, parameters, templateSources);
};

exports.getTemplate = function (parameters) {
    return {
        name: "Application Report - Table",
        description: "Application Table Report",
        extension: "report",
        sources: reportFileTemplate.getSources(),
        parameters: [
            {
                name: "extensionPoint",
                label: "Extension Point",
                placeholder: "Enter Extension Point, if not provided defaults to the project name",
                required: false
            },
            {
                name: "brand",
                label: "Brand",
                placeholder: "Enter Brand"
            },
            {
                name: "brandUrl",
                label: "Brand URL",
                placeholder: "Enter Brand URL"
            },
            {
                name: "title",
                label: "Title",
                placeholder: "Enter Title"
            }]
    };
};